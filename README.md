# ZJUers_simulator
## **å£°æ˜**

è¯¥é¡¹ç›®ä»…ä¾›å¨±ä¹ï¼Œä¸æä¾›ä»»ä½•æ•™å­¦ã€è€ƒè¯•ã€è¡Œæ”¿ã€ç®¡ç†æ–¹é¢çš„å…¶ä»–åŠŸèƒ½ï¼Œä¸€åˆ‡æœ‰å…³å­¦æ ¡å…·ä½“ä¿¡æ¯çš„å†…å®¹ï¼Œç”±[@æµ™æ±Ÿå¤§å­¦](https://www.zju.edu.cn) ä¿ç•™ä¸€åˆ‡æƒåˆ©ã€‚

*æŠ˜å§œå¤§å­¦æ ¡å›­ç”Ÿæ´»æ¨¡æ‹Ÿå™¨* 
## é‚€è¯·ï¼šå…³é”®è¯æ·»åŠ å’Œè¡¥å……
è¯¥æ¸¸æˆæ˜¯ä¸€ä¸ªåŸºäºå¤§æ¨¡å‹çš„æ–‡æœ¬æ¸¸æˆï¼Œworld/keywords.jsonæ˜¯å¤§æ¨¡å‹ç”Ÿæˆå†…å®¹çš„ä¸€ä¸ªé‡è¦æ ¹æ®ï¼Œç›®å‰æ•°æ®è¾ƒä¸ºä¸å…¨ï¼Œæ¬¢è¿æœ‰å…´è¶£çš„uuä»¬åœ¨å…¶ä¸­è¡¥å……å…³é”®ä¿¡æ¯ï¼ˆè¯·å‚ç…§åŸæœ‰jsonè¡¨ç»“æ„ï¼‰

## é¡¹ç›®ç®€ä»‹
æœ¬é¡¹ç›®ä¸ºæŠ˜å§œå¤§å­¦æ ¡å›­ç”Ÿæ´»æ¨¡æ‹Ÿå™¨ï¼Œæ”¯æŒå­¦ä¸šã€é€‰è¯¾ã€æˆå°±ã€äº‹ä»¶ã€å­¦æœŸå¾ªç¯ç­‰ç©æ³•ï¼Œåç«¯åŸºäº FastAPIï¼Œå‰ç«¯åŸºäº HTML/JSï¼Œæ”¯æŒ Docker éƒ¨ç½²å’Œ Cloudflare Tunnel å…¬ç½‘åˆ†æµï¼ˆå¯é€‰ï¼Œå¯èƒ½ä¸ç¨³å®šï¼‰ã€‚
ç›®å‰ï¼Œå¼€å‘è€…@pirate-608 å‘ç°ä½¿ç”¨cloudflare tunnelå…è´¹ç‰ˆä¼šå‡ºç°websocketè¿æ¥ä¸ç¨³å®šçš„é—®é¢˜ï¼Œåˆç”±äºåŸŸåå¤‡æ¡ˆçš„ç¹çæµç¨‹ï¼Œå½“å‰é¡¹ç›®çš„å…¬ç½‘æœåŠ¡æš‚ä¸æ”¯æŒï¼ŒæœŸå¾…æ›´å¤šçˆ±å¥½è€…æ„¿æ„ä¸”æœ‰èƒ½åŠ›å°†è¯¥æ¸¸æˆå‘æ‰¬å…‰å¤§å¹¶éƒ¨ç½²åˆ°å…¬ç½‘ã€‚
å…¶ä»–å…¬ç½‘éƒ¨ç½²æ–¹æ¡ˆï¼š
*	~~[Netlifly](https://www.netlify.com/)~~ï¼ˆè¯¥é¡¹ç›®åç«¯è¾ƒé‡ï¼Œä¸å¯è¡Œï¼‰
*	[fly.io](https://fly.io/)ï¼ˆæ–°å…´æ–¹æ¡ˆï¼Œæ”¶è´¹ï¼Œå¯å°è¯•ï¼‰

## ä¸»è¦åŠŸèƒ½
- å¤šä¸“ä¸š/å­¦é™¢åˆ†æµï¼Œè¯¾ç¨‹åŠ è½½æ¥æºäºworld/coursesç›®å½•ä¸‹jsonæ ¼å¼çš„ç®€åŒ–åŸ¹å…»æ–¹æ¡ˆï¼ˆæ•°æ®æ¥æºäº[æœ¬ç§‘æ•™å­¦ç®¡ç†ä¿¡æ¯æœåŠ¡å¹³å°](https://zdbk.zju.edu.cn/)ï¼‰
- å­¦æœŸå¾ªç¯ã€GPAè®¡ç®—ã€æˆå°±ç³»ç»Ÿï¼Œæ¸¸æˆè¿›è¡Œæ—¶çŠ¶æ€å…¨éƒ¨ä¾èµ–Redisç¼“å­˜ï¼Œä¸ºå…¸å‹IOå¯†é›†å‹é¡¹ç›®ï¼ˆæ•°æ®åº“è¯»å†™ä»…ç”¨äºç™»å½•éªŒè¯ï¼Œåç»­å¯æ‰©å±•ï¼‰ï¼Œ2æ ¸2GæœåŠ¡å™¨å¯ä»¥è½»æ¾æ‰¿è½½300äººæ´»è·ƒåœ¨çº¿
- æ”¯æŒ Cloudflare Tunnel å†…ç½‘ç©¿é€
- æ”¯æŒ HTTPS åå‘ä»£ç†ï¼ˆnginxï¼‰
- æ•°æ®ç»“æ„é«˜åº¦å¯æ‰©å±•ï¼Œæ”¯æŒè‡ªå®šä¹‰åŸ¹å…»æ–¹æ¡ˆ(å¯æ›´æ”¹world/coursesç›®å½•ä¸‹çš„è¡¨ç»“æ„å’Œå­—æ®µ)

## å¿«é€Ÿå¼€å§‹(æ­¤ä¸ºæœ¬åœ°å¼€å‘éƒ¨ç½²æ–¹æ¡ˆï¼Œå¿«é€Ÿä½“éªŒè¯·å‰å¾€[scripts/README.md](scripts/README.md)äº†è§£è¯¦æƒ…)

### ä¸€é”®éƒ¨ç½²ï¼ˆæ¨èï¼Œè·¨å¹³å°ï¼‰

æœ¬é¡¹ç›®æ¨èä½¿ç”¨ Docker éƒ¨ç½²ï¼Œæ”¯æŒ Windowsã€Linuxã€macOSã€‚

## Linux/macOS

### 1. å®‰è£… Docker

#### Ubuntu/Debian
```bash
sudo apt update
sudo apt install -y ca-certificates curl gnupg
sudo install -m 0755 -d /etc/apt/keyrings
curl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo gpg --dearmor -o /etc/apt/keyrings/docker.gpg
echo \
	"deb [arch="$(dpkg --print-architecture)" signed-by=/etc/apt/keyrings/docker.gpg] https://download.docker.com/linux/ubuntu \
	$(. /etc/os-release && echo "$VERSION_CODENAME") stable" | \
	sudo tee /etc/apt/sources.list.d/docker.list > /dev/null
sudo apt update
sudo apt install -y docker-ce docker-ce-cli containerd.io docker-buildx-plugin docker-compose-plugin
sudo systemctl enable --now docker
sudo usermod -aG docker $USER
# é‡æ–°ç™»å½•ç»ˆç«¯ä»¥ç”Ÿæ•ˆ
```

#### macOS (æ¨è Homebrew)
```bash
brew install --cask docker
open /Applications/Docker.app
# ç­‰å¾… Docker å›¾æ ‡å¸¸é©»èœå•æ åå³å¯ç”¨
```

### 2. é…ç½®å¤§æ¨¡å‹ API Keyï¼ˆå¦‚ OpenAI/é€šä¹‰åƒé—®ç­‰ï¼‰

å¯åœ¨ .env æ–‡ä»¶æˆ–å‘½ä»¤è¡Œå¯¼å‡ºç¯å¢ƒå˜é‡ï¼Œç¤ºä¾‹ï¼š

```bash
export OPENAI_API_KEY=sk-xxxxxx
export QWEN_API_KEY=xxxxxx
# å¦‚éœ€æŒä¹…åŒ–å¯å†™å…¥ ~/.bashrc æˆ– ~/.zshrc
```

æˆ–åœ¨ docker-compose.yml ä¸­æ·»åŠ  environment å­—æ®µï¼š
```yaml
	environment:
		- OPENAI_API_KEY=sk-xxxxxx
		- QWEN_API_KEY=xxxxxx
```

### 3. æ‹‰å–ä»£ç å¹¶å¯åŠ¨

```bash
git clone https://github.com/yourname/ZJUers_simulator.git
cd ZJUers_simulator
docker compose up -d --build
```

### 4. è®¿é—®æœåŠ¡

æµè§ˆå™¨æ‰“å¼€ http://localhost:8000

å¦‚éœ€å…³é—­æœåŠ¡ï¼š
```bash
docker compose down
```

## Windows

1. å®‰è£… [Docker](https://www.docker.com/get-started)
2. åœ¨é¡¹ç›®æ ¹ç›®å½•æ‰§è¡Œï¼š
	```bash
	docker-compose up -d --build
	```
3. è®¿é—® http://localhost:8000 ä½“éªŒï¼ˆå¦‚æœ‰ nginxï¼Œå‰ç«¯é™æ€èµ„æºä¸º 80 ç«¯å£ï¼‰

å¦‚éœ€å…³é—­æœåŠ¡ï¼š
```bash
docker-compose down
```

### æ‰‹åŠ¨éƒ¨ç½²ï¼ˆå¼€å‘/è°ƒè¯•ï¼‰

1. å®‰è£… Python 3.11+ï¼Œå¹¶åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ
2. å®‰è£…ä¾èµ–ï¼š
	```bash
	pip install -r requirements.txt
	```
3. å¯åŠ¨åç«¯ï¼š
	```bash
	uvicorn app.main:app --host 0.0.0.0 --port 8000
	```
4. å¯åŠ¨å‰ç«¯ï¼š
	- æ¨èç”¨ nginx åå‘ä»£ç† static/ ç›®å½•
	- æˆ–ç”¨ Python ç®€å• HTTP æœåŠ¡ï¼š
	  ```bash
	  cd static && python -m http.server 8080
	  ```
5. ï¼ˆå¯é€‰ï¼‰ä½¿ç”¨ Cloudflare Tunnel å®ç°å…¬ç½‘è®¿é—®ï¼Œè¯¦è§ tunnel/ ç›®å½•è¯´æ˜

### ğŸ³ Dockerä¸€é”®éƒ¨ç½²ï¼ˆæ¨èï¼‰â­

**æœ€ç¨³å®šçš„éƒ¨ç½²æ–¹æ¡ˆï¼** æ”¯æŒæ‰€æœ‰å¹³å°ï¼Œé›¶é…ç½®å¼€ç®±å³ç”¨ã€‚

#### å¿«é€Ÿå¼€å§‹

```bash
# ä¸‹è½½é¡¹ç›®åï¼Œä¸€é”®éƒ¨ç½²ï¼š

# Windows - åŒå‡»è¿è¡Œ
scripts\deploy.bat

# Linux/macOS - ç»ˆç«¯è¿è¡Œ
chmod +x scripts/deploy.sh && ./scripts/deploy.sh
```

#### è‡ªåŠ¨åŒ–åŠŸèƒ½
- âœ… è‡ªåŠ¨æ£€æµ‹Dockerç¯å¢ƒ
- âœ… è‡ªåŠ¨åˆ›å»ºé…ç½®æ–‡ä»¶
- âœ… è‡ªåŠ¨æ„å»ºå’Œå¯åŠ¨æœåŠ¡
- âœ… è‡ªåŠ¨æ‰“å¼€æµè§ˆå™¨
- âœ… å®Œæ•´çš„é”™è¯¯æç¤ºå’Œè§£å†³æ–¹æ¡ˆ

#### ç®¡ç†å‘½ä»¤
```bash
# æŸ¥çœ‹æœåŠ¡çŠ¶æ€
docker compose ps

# æŸ¥çœ‹è¿è¡Œæ—¥å¿—  
docker compose logs -f

# åœæ­¢æœåŠ¡
docker compose down
# æˆ–ä½¿ç”¨ä¸€é”®åœæ­¢è„šæœ¬
scripts\stop.bat        # Windows
./scripts/stop.sh       # Linux/Mac

# é‡å¯æœåŠ¡
docker compose restart
```

#### é¢„æ„å»ºé•œåƒï¼ˆå³å°†æ¨å‡ºï¼‰
```bash
# ç›´æ¥ä½¿ç”¨é¢„æ„å»ºé•œåƒï¼Œå‡ ç§’å†…å¯åŠ¨
docker pull ghcr.io/yourusername/zjuers_simulator:latest
docker run -d -p 8000:8000 ghcr.io/yourusername/zjuers_simulator:latest
```

## ç›®å½•ç»“æ„
- app/         åç«¯æ ¸å¿ƒä»£ç 
- static/      å‰ç«¯é™æ€èµ„æº
- templates/   å‰ç«¯é¡µé¢æ¨¡æ¿
- world/       è¯¾ç¨‹æ± ã€ä¸“ä¸šæ˜ å°„ç­‰æ•°æ®
- tunnel/      Cloudflare Tunnel é…ç½®(å¯é€‰)
- nginx/       åå‘ä»£ç†ä¸è¯ä¹¦
- c_modules/   Cæ¨¡å—æºç 
- **scripts/**            **éƒ¨ç½²å’Œç®¡ç†è„šæœ¬ç›®å½•**
  - scripts/deploy.py/bat/sh  Dockerä¸€é”®éƒ¨ç½²è„šæœ¬
  - scripts/stop.bat/sh       æœåŠ¡åœæ­¢è„šæœ¬

## è®¸å¯è¯
æœ¬é¡¹ç›®é‡‡ç”¨ MIT License å¼€æºã€‚

## è´¡çŒ®
æ¬¢è¿è¿›è¡Œå…³é”®è¯è¡¥å……ï¼
æ¬¢è¿ PRã€Issue åŠå»ºè®®ï¼

## ä½œè€…
pirate-608
