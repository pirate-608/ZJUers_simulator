<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ZJUers æ¨¡æ‹Ÿå™¨ - æ¸¸æˆè¿›è¡Œä¸­</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="/static/css/style.css" rel="stylesheet">
    <style>
        /* å±€éƒ¨æ ·å¼è°ƒæ•´ */
        .event-log {
            overflow-y: auto;
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            padding: 15px;
            font-family: 'Courier New', Courier, monospace;
        }
        .stat-label { font-size: 0.85rem; color: #666; }
        .bg-light-danger { background-color: #fff5f5; }
        
        /* é’‰é’‰æ¶ˆæ¯æ°”æ³¡æ ·å¼åŸºç¡€ */
        .ding-msg-item { margin-bottom: 8px; font-size: 0.9rem; }
        .ding-avatar { width: 24px; height: 24px; border-radius: 4px; background: #0089FF; color: white; display: inline-flex; align-items: center; justify-content: center; font-size: 12px; margin-right: 8px; }
    </style>
</head>
<body>

<nav class="navbar navbar-dark bg-primary mb-4">
    <div class="container-fluid">
        <span class="navbar-brand mb-0 h1">ZJUers Simulator</span>
        <div class="text-white" id="user-info">
            <span id="display-name">Loading...</span> | 
            <span id="display-major" class="badge bg-warning text-dark">...</span> | 
            <span id="display-semester">å¤§ä¸€ç§‹å†¬</span>
        </div>
    </div>
</nav>

<div class="container-fluid px-4">
    <div class="row">
        <div class="col-md-3">
            <div class="card mb-3">
                <div class="card-header bg-info text-white">ğŸ“š å­¦åœ¨æµ™å¤§</div>
                <div class="card-body p-2">
                    <div id="course-list" class="list-group list-group-flush">
                        <div class="text-center text-muted py-3">åŠ è½½ä¸­...</div>
                    </div>
                </div>
            </div>
            <div class="card mb-3">
                <div class="card-body text-center p-2">
                    <h6 class="card-title mb-1">å½“å‰GPA</h6>
                    <h2 class="display-6 text-primary mb-0" id="gpa-display">0.0</h2>
                </div>
            </div>
        </div>

        <div class="col-md-6">
            
            <div class="card mb-3">
                <div class="card-header">ğŸ“… æ ¡å›­åŠ¨æ€</div>
                <div class="card-body p-0">
                    <div id="event-log" class="event-log border-0" style="height: 300px;">
                        <div class="text-muted p-2">è¿æ¥åˆ°æµ™å¤§æœåŠ¡å™¨ä¸­...</div>
                    </div>
                </div>
                <div class="card-footer py-1">
                    <div class="d-flex justify-content-end">
                        <button class="btn btn-link btn-sm text-decoration-none text-secondary" onclick="clearLog()">æ¸…ç©ºæ—¥å¿—</button>
                    </div>
                </div>
            </div>

            <div class="card mb-3" id="ding-panel">
                <div class="card-header bg-light border-bottom d-flex justify-content-between align-items-center">
                    <span>ğŸ’¬ é’‰é’‰ (DingTalk)</span>
                    <span class="badge bg-danger rounded-pill" id="ding-unread" style="display:none">0</span>
                </div>
                <div class="card-body p-0" style="height: 220px; overflow-y: auto; background: #f7faff;">
                    <div id="ding-messages" class="p-3">
                        <div class="text-center text-muted small mt-4">
                            <p>æš‚æ— æ–°æ¶ˆæ¯</p>
                            <p>ç­çº§ç¾¤é€šçŸ¥ã€è¾…å¯¼å‘˜ç§ä¿¡å°†åœ¨è¿™é‡Œæ˜¾ç¤º</p>
                        </div>
                    </div>
                </div>
                <div class="card-footer bg-white border-top p-2">
                    <form id="ding-form" class="d-flex gap-2" onsubmit="return false;">
                        <input type="text" id="ding-input" class="form-control form-control-sm" placeholder="å›å¤æ¶ˆæ¯... (åŠŸèƒ½å¼€å‘ä¸­)" disabled>
                        <button class="btn btn-primary btn-sm" type="submit" disabled>å‘é€</button>
                    </form>
                </div>
                <div class="d-flex justify-content-center py-3">
                    <button class="btn btn-outline-danger px-4" onclick="sendAction('pause')">â¸ï¸ æš‚åœæ¸¸æˆ</button>
                </div>
            </div>
        </div>

        <div class="col-md-3">
            <div class="card mb-3">
                <div class="card-header bg-success text-white">ğŸ“Š ä¸ªäººçŠ¶æ€</div>
                <div class="card-body">
                    <div class="mb-3">
                        <div class="d-flex justify-content-between stat-label">
                            <span>ç²¾åŠ› (Energy)</span> <span id="val-energy">100/100</span>
                        </div>
                        <div class="progress" style="height: 10px;">
                            <div id="bar-energy" class="progress-bar bg-success" style="width: 100%"></div>
                        </div>
                    </div>
                    
                    <div class="mb-3">
                        <div class="d-flex justify-content-between stat-label">
                            <span>å¿ƒæ€ (Sanity)</span> <span id="val-sanity">50/100</span>
                        </div>
                        <div class="progress" style="height: 10px;">
                            <div id="bar-sanity" class="progress-bar bg-info" style="width: 50%"></div>
                        </div>
                    </div>

                    <div class="mb-3">
                        <div class="d-flex justify-content-between stat-label">
                            <span>å‹åŠ› (Stress)</span> <span id="val-stress">0/100</span>
                        </div>
                        <div class="progress" style="height: 10px;">
                            <div id="bar-stress" class="progress-bar bg-danger" style="width: 0%"></div>
                        </div>
                    </div>

                    <hr class="my-2">

            <div class="row g-1 small"> <div class="col-6">
                    <span class="text-muted">æ™ºå•†ï¼ˆIQï¼‰:</span> <span id="val-iq" class="fw-bold">--</span>
                </div>
                <div class="col-6">
                    <span class="text-muted">æƒ…å•†ï¼ˆEQï¼‰:</span> <span id="val-eq" class="fw-bold">--</span>
                </div>
                <div class="col-6">
                    <span class="text-muted">è¿æ°”ï¼ˆLuckï¼‰:</span> <span id="val-luck" class="fw-bold">--</span>
                </div>
                <div class="col-6">
                    <span class="text-muted">é£è¯„ï¼ˆReputationï¼‰:</span> <span id="val-reputation" class="fw-bold">0</span>
                </div>
            </div>

            <div class="card mb-3">
                <div class="card-header bg-warning text-dark">â˜• æ‘¸é±¼ä¼‘é—²</div>
                <div class="card-body d-grid gap-2">
                    <button class="btn btn-outline-primary" onclick="sendAction('relax', 'gym')">ğŸ‹ï¸â€â™‚ï¸ å¥èº«æˆ¿ (+ç²¾åŠ›/å¿ƒæ€)</button>
                    <button class="btn btn-outline-success" onclick="sendAction('relax', 'game')">ğŸ® æ‰“æ¸¸æˆ (+å¿ƒæ€ -ç²¾åŠ›)</button>
                    <button class="btn btn-outline-info" onclick="sendAction('relax', 'cc98')">ğŸŒŠ åˆ·CC98 (éšæœºå¿ƒæ€)</button>
                    <button class="btn btn-outline-secondary" onclick="sendAction('relax', 'walk')">ğŸš¶ æ•£æ­¥å¯çœŸæ¹– (-å‹åŠ›)</button>
                </div>
            </div>

            <div id="exam-console-container" class="mb-3">
                </div>
        </div>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="/static/js/config.js"></script>
<script src="/static/js/game.js"></script>

<div class="modal fade" id="summaryModal" tabindex="-1" data-bs-backdrop="static">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header bg-primary text-white">
                <h5 class="modal-title">ğŸ“„ å­¦æœŸæˆç»©å•</h5>
            </div>
            <div class="modal-body">
                <table class="table table-striped">
                    <thead>
                        <tr><th>è¯¾ç¨‹</th><th>æˆç»©</th><th>ç»©ç‚¹</th></tr>
                    </thead>
                    <tbody id="transcript-body"></tbody>
                </table>
                <div class="alert alert-info text-center">
                    æœ¬å­¦æœŸ GPA: <strong id="transcript-gpa" class="fs-4">0.0</strong>
                </div>
                <div id="transcript-msg" class="text-center text-muted mb-2"></div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-primary" onclick="nextSemester()">è¿›å…¥ä¸‹ä¸€å­¦å¹´</button>
            </div>
        </div>
    </div>
</div>
</body>
</html>